!function(t){"use strict";jQuery(document).ready((function(){if("undefined"!=typeof gtm4wp_datalayer_name&&"undefined"!=typeof gtm4wp_first_container_id&&(t(document).on("viwcaio_found_variation",(function(t,e){if(void 0===e||!e||!e.variation_id)return!1;if("interactive"===document.readyState&&gtm4wp_changedetail_fired_during_pageload)return!1;let a=t.target,c={name:a.getAttribute("data-product_name"),id:e.variation_id,price:e.display_price,category:a.querySelector("[name=gtm4wp_category]")&&a.querySelector("[name=gtm4wp_category]").value,stocklevel:a.querySelector("[name=gtm4wp_stocklevel]")&&a.querySelector("[name=gtm4wp_stocklevel]").value,brand:a.querySelector("[name=gtm4wp_brand]")&&a.querySelector("[name=gtm4wp_brand]").value,variant:""};gtm4wp_use_sku_instead&&e.sku&&""!==e.sku&&(c.id=e.sku);let r=[];for(let t in e.attributes)r.push(e.attributes[t]);c.variant=r.join(","),"undefined"==typeof gtm4wp_last_selected_product_variation&&(window.gtm4wp_last_selected_product_variation=c),gtm4wp_last_selected_product_variation=c,window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.changeDetailViewEEC",ecommerce:{currencyCode:gtm4wp_currency,detail:{products:[c]}},ecomm_prodid:gtm4wp_id_prefix+c.id,ecomm_pagetype:"product",ecomm_totalvalue:c.price}),window[gtm4wp_datalayer_name].push({event:"view_item",ecommerce:{currency:gtm4wp_currency,value:c.price,items:[gtm4wp_map_eec_to_ga4(c)]}}),"interactive"===document.readyState&&(window.gtm4wp_changedetail_fired_during_pageload=!0)})),t(document.body).on("click",".vi-wcaio-product-bt-atc:not(.vi-wcaio-button-swatches-disable):not(.vi-wcaio-product-bt-atc-disabled):not(.vi-wcaio-product-bt-not-atc):not(.vi-wcaio-product-bt-atc-loading)",(function(e){let a=t(this).closest(".vi-wcaio-sb-cart-form, .vi-wcaio-va-cart-form, .vi-wcaio-sidebar-cart-footer-pd");if(!a.length)return!0;if(a.find("[name=variation_id]").length)gtm4wp_last_selected_product_variation&&(gtm4wp_last_selected_product_variation.quantity=a.find("[name=quantity]").val()||1,window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[gtm4wp_last_selected_product_variation]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:gtm4wp_last_selected_product_variation.price*gtm4wp_last_selected_product_variation.quantity,items:[gtm4wp_map_eec_to_ga4(gtm4wp_last_selected_product_variation)]}}));else{let e=a.hasClass("vi-wcaio-sidebar-cart-footer-pd")?{id:gtm4wp_use_sku_instead?t(this).data("product_sku"):t(this).data("product_id"),name:t(this).data("product_name"),price:parseFloat(t(this).data("product_price")),quantity:t(this).find("[name=quantity]").val()||1}:{id:gtm4wp_use_sku_instead?a.data("product_sku"):a.data("product_id"),name:a.data("product_name")||a.find("[name=gtm4wp_name]").val(),price:parseFloat(a.data("product_price")||a.find("[name=gtm4wp_price]").val()),quantity:a.find("[name=quantity]").val()||1,category:a.find("[name=gtm4wp_category]").val(),stocklevel:a.find("[name=gtm4wp_stocklevel]").val(),brand:a.find("[name=gtm4wp_brand]").val()};window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[e]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:e.price*e.quantity,items:[gtm4wp_map_eec_to_ga4(e)]}})}})),t(document).on("viwcaio_before_remove_from_cart",(function(e,a){let c=t(a).closest(".vi-wcaio-sidebar-cart-pd-wrap"),r=c.find(".vi_wcaio_qty").val();if(!r)return!1;let i={name:c.data("gtm4wp_product_name"),id:c.data("gtm4wp_product_id"),price:c.data("gtm4wp_product_price"),category:c.data("gtm4wp_product_cat"),variant:c.data("gtm4wp_product_variant"),stocklevel:c.data("gtm4wp_product_stocklevel"),brand:c.data("gtm4wp_product_brand"),quantity:r};window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.removeFromCartEEC",ecommerce:{currencyCode:gtm4wp_currency,remove:{products:[i]}}}),window[gtm4wp_datalayer_name].push({event:"remove_from_cart",ecommerce:{currency:gtm4wp_currency,value:i.price*i.quantity,items:[gtm4wp_map_eec_to_ga4(i)]}})})),t(document).on("viwcaio_before_update_cart",(function(e){t(".vi-wcaio-sidebar-cart-pd-wrap .vi_wcaio_qty_update").each((function(e,a){let c=parseFloat(t(this).prop("defaultValue")),r=parseFloat(t(this).val());if(isNaN(r)&&(r=c),r===c)return!0;let i=t(this).closest(".vi-wcaio-sidebar-cart-pd-wrap"),o={name:i.data("gtm4wp_product_name"),id:i.data("gtm4wp_product_id"),price:parseFloat(i.data("gtm4wp_product_price")||0).toFixed(2),category:i.data("gtm4wp_product_cat"),variant:i.data("gtm4wp_product_variant"),stocklevel:i.data("gtm4wp_product_stocklevel"),brand:i.data("gtm4wp_product_brand"),quantity:r};c<r?(o.quantity=r-c,window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.addProductToCartEEC",ecommerce:{currencyCode:gtm4wp_currency,add:{products:[o]}}}),window[gtm4wp_datalayer_name].push({event:"add_to_cart",ecommerce:{currency:gtm4wp_currency,value:o.price*o.quantity,items:[gtm4wp_map_eec_to_ga4(o)]}})):(o.quantity=c-r,window[gtm4wp_datalayer_name].push({event:"viwcaio.gtm4wp.removeFromCartEEC",ecommerce:{currencyCode:gtm4wp_currency,remove:{products:[o]}}}),window[gtm4wp_datalayer_name].push({event:"remove_from_cart",ecommerce:{currency:gtm4wp_currency,value:o.price*o.quantity,items:[gtm4wp_map_eec_to_ga4(o)]}}))}))}))),"undefined"!=typeof viwcaio_effect_atc&&viwcaio_effect_atc.effect){let e=1;setTimeout((function(){t(document.body).trigger("viwcaio_effect_atc")}),200),t(document.body).on("viwcaio_effect_atc",(function(){if(!t("form.cart:not(.viwcaio_effect_atc-init),.variations_form:not(.viwcaio_effect_atc-init),.vi-wcaio-sb-cart-form:not(.viwcaio_effect_atc-init)").length)return setTimeout((function(){if(e<6)return e++,t(document.body).trigger("viwcaio_effect_atc"),!1;e=1}),500),!1;t(this).find(".single_add_to_cart_button, .vi-wcaio-product-bt-atc").addClass("viwcaio-effect-"+viwcaio_effect_atc.effect)})),t(document).on("ajaxComplete",(function(){return setTimeout((function(){t(document.body).trigger("viwcaio_effect_atc")}),100),!1}))}}))}(jQuery);